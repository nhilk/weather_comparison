2025-03-29 13:49:10,952 - asyncio - DEBUG - Using selector: EpollSelector
2025-03-29 13:49:10,952 - database.db - DEBUG - connecting to the database
2025-03-29 13:49:10,983 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-29 13:49:10,983 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:49:10,985 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-29 13:49:10,985 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:49:10,986 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-29 13:49:10,986 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:49:10,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:49:10,989 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:49:10,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.00017s] {'table_name': 'api_data', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:49:10,992 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:49:10,992 - sqlalchemy.engine.Engine - INFO - [cached since 0.002804s ago] {'table_name': 'fact_weather', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:49:10,993 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:49:10,993 - sqlalchemy.engine.Engine - INFO - [cached since 0.003709s ago] {'table_name': 'source_comparison', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:49:10,994 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:49:10,994 - sqlalchemy.engine.Engine - INFO - [cached since 0.004643s ago] {'table_name': 'dim_location', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:49:10,995 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-29 13:49:56,727 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:49:56,729 - sqlalchemy.engine.Engine - INFO - INSERT INTO weather_comp.api_data (source, date, ingested, data) VALUES (%(source)s, %(date)s, %(ingested)s, %(data)s::JSON) RETURNING weather_comp.api_data.id
2025-03-29 13:49:56,729 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] {'source': 'https://ambientweather.net', 'date': datetime.datetime(2025, 3, 29, 13, 49, 56, 725034), 'ingested': None, 'data': '{"dateutc": 1743270540000, "tempinf": 77.7, "battin": 1, "humidityin": 50, "baromrelin": 30.11, "baromabsin": 30.11, "tempf": 83.1, "battout": 1, "hu ... (419 characters truncated) ... 32:00.000Z", "tz": "America/New_York", "date": "2025-03-29T17:49:00.000Z", "macAddress": "48:3F:DA:54:AF:D2", "source": "https://ambientweather.net"}'}
2025-03-29 13:49:56,731 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-29 13:49:56,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:49:56,734 - sqlalchemy.engine.Engine - INFO - SELECT weather_comp.dim_location.id AS weather_comp_dim_location_id, weather_comp.dim_location.city AS weather_comp_dim_location_city, weather_comp.dim_location.state AS weather_comp_dim_location_state, weather_comp.dim_location.country AS weather_comp_dim_location_country, weather_comp.dim_location.latitude AS weather_comp_dim_location_latitude, weather_comp.dim_location.longitude AS weather_comp_dim_location_longitude 
FROM weather_comp.dim_location 
WHERE weather_comp.dim_location.latitude = %(latitude_1)s AND weather_comp.dim_location.longitude = %(longitude_1)s
2025-03-29 13:49:56,734 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] {'latitude_1': 26.16123, 'longitude_1': -81.80686}
2025-03-29 13:49:56,736 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-29 13:49:56,737 - database.db - INFO - Location already exists in the database with id 1
2025-03-29 13:49:57,045 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:49:57,052 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:49:57,052 - sqlalchemy.engine.Engine - INFO - [cached since 43.81s ago] {'table_name': 'fact_weather', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:49:57,058 - sqlalchemy.engine.Engine - INFO - INSERT INTO weather_comp.fact_weather (date, source, location_id, temperature, pressure, humidity, wind_direction, wind_speed, wind_gust, daily_precipitation) VALUES (%(date)s, %(source)s, %(location_id)s, %(temperature)s, %(pressure)s, %(humidity)s, %(wind_direction)s, %(wind_speed)s, %(wind_gust)s, %(daily_precipitation)s)
2025-03-29 13:49:57,058 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] {'date': datetime.datetime(2025, 3, 29, 17, 49, tzinfo=<UTC>), 'source': 'https://ambientweather.net', 'location_id': 1, 'temperature': 83.1, 'pressure': 30.11, 'humidity': 59, 'wind_direction': 110, 'wind_speed': 8.5, 'wind_gust': 13.9, 'daily_precipitation': 0}
2025-03-29 13:49:57,060 - database.db - INFO - Data written to FactWeather table
2025-03-29 13:49:57,060 - sqlalchemy.engine.Engine - INFO - COMMIT
