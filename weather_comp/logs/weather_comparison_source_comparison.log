2025-03-29 13:52:37,578 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-29 13:52:37,578 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:52:37,580 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-29 13:52:37,580 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:52:37,581 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-29 13:52:37,581 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-29 13:52:37,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:52:37,584 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:52:37,584 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s] {'table_name': 'api_data', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:52:37,587 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:52:37,587 - sqlalchemy.engine.Engine - INFO - [cached since 0.0031s ago] {'table_name': 'fact_weather', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:52:37,588 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:52:37,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.004052s ago] {'table_name': 'source_comparison', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:52:37,589 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:52:37,589 - sqlalchemy.engine.Engine - INFO - [cached since 0.004925s ago] {'table_name': 'dim_location', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:52:37,590 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-29 13:52:37,591 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:52:37,592 - sqlalchemy.engine.Engine - INFO - SELECT s1.source AS source1, s2.source AS source2, s1.location_id, s1.date AS date1, s2.date AS date2, s1.temperature - s2.temperature AS temperature 
FROM weather_comp.fact_weather AS s1, weather_comp.fact_weather AS s2 
WHERE s1.source = %(source_1)s AND date_trunc(%(date_trunc_1)s, s1.date) = date_trunc(%(date_trunc_2)s, s2.date) AND s1.id != s2.id
2025-03-29 13:52:37,592 - sqlalchemy.engine.Engine - INFO - [generated in 0.00013s] {'source_1': 'https://ambientweather.net', 'date_trunc_1': 'hour', 'date_trunc_2': 'hour'}
2025-03-29 13:52:37,599 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-29 13:52:37,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-29 13:52:37,855 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_namespace.nspname = %(nspname_1)s
2025-03-29 13:52:37,855 - sqlalchemy.engine.Engine - INFO - [cached since 0.2708s ago] {'table_name': 'source_comparison', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'weather_comp'}
2025-03-29 13:52:37,858 - sqlalchemy.engine.Engine - INFO - INSERT INTO weather_comp.source_comparison (source1, source2, location_id, date1, date2, temperature) VALUES (%(source1__0)s, %(source2__0)s, %(location_id__0)s, %(date1__0)s, %(date2__0)s, %(temperature__0)s), (%(source1__1)s, %(source2__1)s, %(loca ... 993 characters truncated ... rce1__11)s, %(source2__11)s, %(location_id__11)s, %(date1__11)s, %(date2__11)s, %(temperature__11)s)
2025-03-29 13:52:37,858 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s (insertmanyvalues) 1/1 (unordered)] {'date1__0': datetime.datetime(2025, 3, 7, 19, 5), 'source2__0': 'https://api.weather.gov', 'location_id__0': 1, 'source1__0': 'https://ambientweather.net', 'temperature__0': 2.4000000000000057, 'date2__0': datetime.datetime(2025, 3, 7, 19, 0), 'date1__1': datetime.datetime(2025, 3, 10, 21, 16), 'source2__1': 'https://api.weather.gov', 'location_id__1': 1, 'source1__1': 'https://ambientweather.net', 'temperature__1': 3.4000000000000057, 'date2__1': datetime.datetime(2025, 3, 10, 21, 0), 'date1__2': datetime.datetime(2025, 3, 7, 19, 5), 'source2__2': 'https://api.weather.gov', 'location_id__2': 1, 'source1__2': 'https://ambientweather.net', 'temperature__2': 2.4000000000000057, 'date2__2': datetime.datetime(2025, 3, 7, 19, 0), 'date1__3': datetime.datetime(2025, 3, 10, 21, 16), 'source2__3': 'https://api.weather.gov', 'location_id__3': 1, 'source1__3': 'https://ambientweather.net', 'temperature__3': 3.4000000000000057, 'date2__3': datetime.datetime(2025, 3, 10, 21, 0), 'date1__4': datetime.datetime(2025, 3, 7, 19, 5), 'source2__4': 'https://api.weather.gov', 'location_id__4': 1, 'source1__4': 'https://ambientweather.net', 'temperature__4': 2.4000000000000057, 'date2__4': datetime.datetime(2025, 3, 7, 19, 0), 'date1__5': datetime.datetime(2025, 3, 10, 21, 16), 'source2__5': 'https://api.weather.gov', 'location_id__5': 1, 'source1__5': 'https://ambientweather.net', 'temperature__5': 3.4000000000000057, 'date2__5': datetime.datetime(2025, 3, 10, 21, 0), 'date1__6': datetime.datetime(2025, 3, 7, 19, 5), 'source2__6': 'https://api.weather.gov', 'location_id__6': 1, 'source1__6': 'https://ambientweather.net', 'temperature__6': 2.4000000000000057, 'date2__6': datetime.datetime(2025, 3, 7, 19, 0), 'date1__7': datetime.datetime(2025, 3, 10, 21, 16), 'source2__7': 'https://api.weather.gov', 'location_id__7': 1, 'source1__7': 'https://ambientweather.net', 'temperature__7': 3.4000000000000057, 'date2__7': datetime.datetime(2025, 3, 10, 21, 0), 'date1__8': datetime.datetime(2025, 3, 10, 21, 16), 'source2__8': 'https://api.weather.gov', 'location_id__8': 1, 'source1__8': 'https://ambientweather.net', 'temperature__8': 3.4000000000000057, 'date2__8': datetime.datetime(2025, 3, 10, 21, 0), 'date1__9': datetime.datetime(2025, 3, 17, 18, 4), 'source2__9': 'https://api.weather.gov', 'location_id__9': 1, 'source1__9': 'https://ambientweather.net', 'temperature__9': 1.7000000000000028, 'date2__9': datetime.datetime(2025, 3, 17, 18, 0), 'date1__10': datetime.datetime(2025, 3, 29, 17, 49), 'source2__10': 'https://api.weather.gov', 'location_id__10': 1, 'source1__10': 'https://ambientweather.net', 'temperature__10': 2.0999999999999943, 'date2__10': datetime.datetime(2025, 3, 29, 17, 0), 'date1__11': datetime.datetime(2025, 3, 29, 17, 49), 'source2__11': 'https://api.weather.gov', 'location_id__11': 1, 'source1__11': 'https://ambientweather.net', 'temperature__11': 2.0999999999999943, 'date2__11': datetime.datetime(2025, 3, 29, 17, 0)}
2025-03-29 13:52:37,861 - sqlalchemy.engine.Engine - INFO - COMMIT
